/* ========================================================= */
/*  css/game.css (VERSI칍N FINAL CON SPRITES)                 */
/* ========================================================= */

:root {
    --font-pixel: 'Press Start 2P', cursive;
    --color-text: #fff1e8;
    --color-shadow: #2c2137;
    --color-highlight: #ff77a8;
    --color-plot-border: #633b25;
}

* { margin: 0; padding: 0; box-sizing: border-box; image-rendering: pixelated; }

body {
    font-family: var(--font-pixel);
    color: var(--color-text);
    overflow: hidden;
    height: 100vh; width: 100vw;
    cursor: url('../assets/cursor_large.png') 8 8, auto;
    background-color: #5f8033; /* Color de respaldo */
    background-image: url('../assets/farm_background.png');
    background-repeat: repeat;
}

#game-container {
    display: flex; flex-direction: column;
    height: 100%; width: 100%;
    max-width: 800px; margin: 0 auto;
}

#resource-bar, #action-panel, .modal-content {
    padding: 1.5rem;
    flex-shrink: 0;
    border-style: solid;
    border-width: 16px;
    border-image-source: url('../assets/ui_panel_border.png');
    border-image-slice: 4;
    border-image-repeat: repeat;
    background-color: #432834;
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
}

#resource-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 1rem;
    padding: 0.25rem 0.75rem; /* Reducimos a칰n m치s el padding */
    border-width: 12px;      /* Borde m치s fino */
    border-image-source: url('../assets/ui_panel_border.png');
    border-image-slice: 4;
    border-image-repeat: repeat;
    background-color: #432834;
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
    text-shadow: 2px 2px 0 var(--color-shadow);
    flex-wrap: nowrap;
}
#resource-bar {
    flex-wrap: nowrap; 
}

#action-panel {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;   
    gap: 1rem;     
}

#camera-viewport {
    flex-grow: 1;
    overflow: hidden;
    cursor: grab;
    position: relative;
}

#camera-viewport:active {
    cursor: grabbing;
}

#farm-view {
    display: grid;
    gap: 2px;
	position: absolute;
}

.grid-tile {
    width: 64px;
    height: 64px;
    background-size: cover;
    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.1); 
}
.grass-tile {
    background-color: #5f8033;
}
.water-tile {
    background-image: url('../assets/tilemar.png');
    background-size: cover;
}
.plot {
    border: 4px solid var(--color-plot-border);
    box-shadow: inset 0 0 10px rgba(0,0,0,0.4);
    cursor: pointer;
    transition: transform 0.1s;
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
    position: relative;
    border-radius: 8px;
}
.plot:hover {
    transform: scale(1.05);
}
.plot-timer {
    position: absolute; bottom: 5px; right: 5px;
    background-color: rgba(0, 0, 0, 0.7);
    color: #fef4e8;
    padding: 5px 8px; font-size: 0.8rem;
    text-shadow: 2px 2px 0 var(--color-shadow);
    border: 2px solid #222034; border-radius: 5px;
}
.plot-timer.hidden { display: none; }

/* --- ESTILOS PARA PARCELAS BLOQUEADAS --- */
.plot.plot-locked {
    background-color: #523525;
    background-image: none; /* Quitamos la textura de tierra arada */
}
.plot-buy-overlay {
    position: absolute; top: 0; left: 0;
    width: 100%; height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    color: var(--color-text);
    text-shadow: 2px 2px 0 var(--color-shadow);
    font-size: 1.2rem;
}
.plot-buy-overlay.hidden { display: none; }
.plot-buy-overlay::before {
    content: '游';
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
}

/* --- SPRITES DE LAS PARCELAS --- */
.plot-empty { background-image: url('../assets/plot.png'); }
.plot-carrot-stage-0 { background-image: url('../assets/crop_carrot_stage_0.png'); }
.plot-carrot-stage-1 { background-image: url('../assets/crop_carrot_stage_1.png'); }
.plot-carrot-stage-2 { background-image: url('../assets/crop_carrot_stage_2.png'); }
.plot-carrot-stage-3 { background-image: url('../assets/crop_carrot_stage_3.png'); }

.action-button, .modal-button {
    font-family: var(--font-pixel); font-size: 1rem; color: var(--color-text);
    background-color: #754641; border: none;
    border-bottom: 4px solid #4D2D28;
    padding: 1rem 1.5rem; cursor: pointer;
    transition: all 0.1s ease-out;
    text-shadow: 2px 2px 0 var(--color-shadow);
    border-radius: 8px;
}
.action-button:hover, .modal-button:hover { background-color: #9D5953; }
.action-button:active, .action-button.active {
    transform: translateY(4px);
    border-bottom: 0px;
    background-color: #9D5953;
}

.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); display: flex; justify-content: center; align-items: center; z-index: 1000; }
.modal-overlay.hidden { display: none; }
.modal-content { max-width: 600px; width: 90%; text-align: center; }
.modal-content h2 { font-size: 1.5rem; margin-bottom: 2rem; color: var(--color-text); text-shadow: 2px 2px 0 var(--color-shadow); }
#shop-items {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-bottom: 2rem;
    max-height: 50vh;
    overflow-y: auto;
    padding-right: 1rem;
}
.shop-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background-color: #00000025;
    padding: 1rem;
    border: 3px solid #6e4958;
    border-radius: 8px;
}
.shop-item img { width: 48px; height: 48px; }
.item-details { text-align: left; flex-grow: 1; margin: 0 1rem; }

@media (max-width: 600px) {
    .plot { width: 120px; height: 120px; }
    #farm-view { gap: 15px; padding: 15px; }

    .action-button, .modal-button {
        font-size: 0.8rem;
        padding: 0.8rem 1rem;
        flex-grow: 1;   
        flex-basis: 40%; 
    }

    #action-panel {
        padding: 0.8rem;
        gap: 0.8rem; 
    }
    
    #resource-bar {
        padding: 0.8rem;
        font-size: 1rem;
    }
}

/* --- ESTILOS PARA LA BARRA DE NIVEL Y XP --- */
.level-container {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    width: 100%; /* Ocupa el espacio disponible */
    grid-column: 1 / -1; /* Si usas grid, para que ocupe toda la fila */
    padding: 0.5rem 0;
}
.level-badge {
    background-color: #9D5953;
    padding: 0.5rem;
    border-radius: 50%;
    font-size: 0.8rem;
    min-width: 50px;
    text-align: center;
    border: 2px solid var(--color-shadow);
}
.xp-bar-background {
    flex-grow: 1;
    height: 25px;
    background-color: var(--color-shadow);
    border: 2px solid #222034;
    border-radius: 15px;
    position: relative;
    overflow: hidden;
}
.xp-bar-fill {
    height: 100%;
    width: 0%; /* Empezamos en 0% */
    background-color: #83d6a6;
    transition: width 0.3s ease-out; /* Animaci칩n suave */
}
.xp-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 0.8rem;
    color: var(--color-text);
    text-shadow: 1px 1px 0 var(--color-shadow);
    white-space: nowrap;
}

/* --- ESTILOS MEJORADOS PARA EL MODAL DE HABILIDADES --- */
#skills-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    margin-bottom: 2rem;
}
.skill-entry {
    background-color: rgba(0,0,0,0.2);
    padding: 1rem;
    border-radius: 8px;
    border: 2px solid var(--color-plot-border);
}
.skill-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}
.skill-name {
    font-size: 1.2rem;
    color: #feeb7a;
}
.skill-next-unlock {
    font-size: 0.8rem;
    opacity: 0.8;
}
.skill-xp-bar {
    height: 20px;
    margin-bottom: 1rem;
}
.skill-entry h4 {
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
    opacity: 0.9;
}
.skill-unlocks-container {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}
.skill-unlock {
    font-size: 0.9rem;
}
.skill-unlock.unlocked {
    color: #83d6a6; /* Verde para lo desbloqueado */
}
.skill-unlock.locked {
    color: var(--color-text);
    opacity: 0.6; /* Atenuado para lo bloqueado */
}

/* --- ESTILOS PARA EL MODAL DE MISIONES --- */
#quests-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem; /* Espacio entre cada misi칩n */
    margin-bottom: 2rem;
    max-height: 40vh; /* L칤mite de altura para que sea scrollable en pantallas peque침as */
    overflow-y: auto; /* A침ade barra de scroll si el contenido es muy alto */
    padding-right: 1rem; /* Espacio para la barra de scroll */
}
.modal-subtitle {
    font-size: 0.8rem;
    opacity: 0.8;
    margin-top: -1.5rem;
    margin-bottom: 2rem;
}
.quest-entry {
    background-color: rgba(0,0,0,0.2);
    border: 2px solid var(--color-plot-border);
    padding: 1rem;
    border-radius: 8px;
    text-align: left;
}
.quest-title {
    color: var(--color-highlight);
    font-size: 1.2rem;
    margin-bottom: 0.5rem;
}
.quest-description {
    font-size: 0.8rem;
    margin-bottom: 1rem;
    opacity: 0.9;
}
.quest-details {
    display: flex;
    gap: 1rem;
    margin-bottom: 1.5rem;
}
.quest-requirements, .quest-rewards {
    flex-basis: 50%;
}
.quest-details h4 {
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
}
.quest-details span {
    display: block;
    font-size: 0.8rem;
}
.quest-entry button {
    width: 100%;
}
.quest-entry button:disabled {
    background-color: #4D2D28;
    border-bottom-color: #2c2137;
    opacity: 0.6;
    cursor: not-allowed;
}

/* --- ESTILOS PARA EL MODAL DE RECOMPENSA DIARIA --- */
.daily-reward-presentation {
    background-color: rgba(0,0,0,0.2);
    border-radius: 8px;
    padding: 2rem 1rem;
    margin: 2rem 0;
    text-align: center;
}
.daily-reward-presentation h3 {
    margin: 1rem 0 0.5rem 0;
}
.daily-reward-presentation p {
    color: #83d6a6; /* Un color verde para destacar */
    font-size: 1.2rem;
}
.daily-reward-presentation .gift-icon { /* Reemplaza el emoji si prefieres una imagen */
    font-size: 4rem;
}

.item-actions {
    display: flex;
    flex-direction: column; /* Botones uno encima del otro */
    gap: 0.5rem; /* Peque침o espacio entre botones */
}

/* --- ESTILOS MEJORADOS PARA EL MODAL DEL 츼RBOL DE TALENTOS --- */
.talent-points-display {
    margin-top: -1.5rem;
    margin-bottom: 1rem;
    font-size: 1rem;
    color: #83d6a6;
    text-shadow: 2px 2px 0 var(--color-shadow);
}

#talent-tree-container {
    display: grid;
    grid-template-columns: repeat(4, 1fr); /* 4 columnas de igual tama침o */
    gap: 30px 20px; /* 30px de espacio vertical, 20px horizontal */
    padding: 20px;
    margin-bottom: 2rem;
    max-height: 55vh; /* Altura m치xima antes de que aparezca el scroll */
    overflow-y: auto; /* Scroll vertical si es necesario */
}

.talent-node {
    border: 3px solid var(--color-plot-border);
    background-color: rgba(0,0,0,0.3);
    border-radius: 8px;
    padding: 0.5rem;
    text-align: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative;
    cursor: pointer;
    transition: all 0.2s ease;
    min-height: 80px; /* Altura m칤nima para que el grid se vea bien */
}
.talent-node:hover {
    background-color: rgba(0,0,0,0.5);
    transform: scale(1.05);
}
.talent-name { font-size: 0.8rem; color: var(--color-text); }
.talent-rank { font-size: 0.9rem; color: #feeb7a; margin-top: 0.25rem; }

/* Estados de los Nodos */
.talent-node.locked { opacity: 0.5; background-color: var(--color-shadow); cursor: not-allowed; }
.talent-node.available { border-color: #83d6a6; box-shadow: 0 0 10px #83d6a6; }
.talent-node.maxed { border-color: #feeb7a; }

/* --- CONECTORES VISUALES --- */
/* Base para todos los conectores */
.talent-node::before {
    content: '';
    position: absolute;
    background-color: var(--color-plot-border);
    z-index: -1; /* Detr치s del nodo */
}
/* Conector que va hacia ARRIBA (para conectar con el nodo padre) */
.connector-up::before {
    width: 4px;
    height: calc(30px + 3px); /* Altura del gap + borde */
    left: 50%;
    transform: translateX(-50%);
    bottom: 100%;
}
/* Conector que va en DIAGONAL ARRIBA-IZQUIERDA */
.connector-up-left::before {
    width: calc(50% + 10px + 2px); /* Mitad del nodo + mitad del gap + mitad del grosor de la l칤nea */
    height: 4px;
    left: 50%;
    bottom: 50%;
    transform: translateY(-50%) skewY(25deg);
    transform-origin: left;
}
/* Conector que va en DIAGONAL ARRIBA-DERECHA */
.connector-up-right::before {
    width: calc(50% + 10px + 2px);
    height: 4px;
    right: 50%;
    bottom: 50%;
    transform: translateY(-50%) skewY(-25deg);
    transform-origin: right;
}
/* Coloreamos el conector si el nodo est치 desbloqueado */
.talent-node.unlocked::before, .talent-node.maxed::before {
    background-color: #feeb7a;
}

/* Tooltip para mostrar la descripci칩n */
.modal-content {
    position: relative; /* 춰MUY IMPORTANTE! */
}

#talent-tooltip-central {
    position: absolute; /* Flotar치 por encima del contenido */
    bottom: 80px; /* Posicionado cerca del bot칩n de cerrar */
    left: 50%;
    transform: translateX(-50%); /* Centrado horizontalmente */
    
    background-color: var(--color-shadow);
    border: 2px solid var(--color-ui-bg);
    border-radius: 8px;
    padding: 1rem;
    text-align: left;
    width: 90%;
    max-width: 400px;
    font-size: 0.8rem;
    
    opacity: 0; /* Empezamos invisible */
    visibility: hidden;
    pointer-events: none; /* No se puede interactuar con 칠l */
    transition: opacity 0.2s ease-out, visibility 0.2s ease-out;
    z-index: 10; /* Aseguramos que est칠 por encima del 치rbol */
}
#talent-tooltip-central.visible {
    opacity: 1;
    visibility: visible;
}
.tooltip-title {
    font-size: 1rem;
    color: #feeb7a;
    margin-bottom: 0.5rem;
}
.tooltip-desc { margin-bottom: 0.5rem; }
.tooltip-req, .tooltip-cost, .tooltip-rank { opacity: 0.8; }
.tooltip-req.met { color: #83d6a6; }
.tooltip-req.unmet { color: #ff77a8; }

/* css/game.css */
.inventory-entry[data-item-id*="_seed"]:hover {
    background-color: rgba(0,0,0,0.5); /* Se ilumina al pasar el rat칩n */
}
.inventory-entry[data-item-id*="_seed"] {
    cursor: pointer; /* Muestra un cursor de mano sobre las semillas */
}

/* --- ESTILOS PARA EL MODO CONSTRUCCI칍N --- */
#build-items-container {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    justify-content: center;
    margin-bottom: 2rem;
}
.build-item {
    flex-direction: column;
    cursor: pointer;
    padding: 1rem;
}
.build-item:hover {
    background-color: rgba(0,0,0,0.5);
}
.build-item img {
    width: 64px; height: 64px;
    margin-bottom: 0.5rem;
}

/* Estilos para la VISTA FANTASMA */
.ghost-preview {
    position: absolute;
    top: 0; 
    left: 0;
    background-color: rgba(131, 214, 166, 0.5);
    border: 2px dashed #ffffff;
    z-index: 5;
    pointer-events: none;
}
.ghost-preview.invalid {
    background-color: rgba(255, 119, 168, 0.5);
    border-color: #ff77a8;
}

.resource-bar-left, .resource-bar-center, .resource-bar-right {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.resource-bar-center {
    flex-grow: 1; /* Ocupa el espacio sobrante en el centro */
    justify-content: center; /* Centra los recursos */
}

/* MODIFICADO: Ajustamos el level-container para que no ocupe toda la fila */
.level-container {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    width: 200px;
}


/* --- NUEVAS REGLAS para los botones de icono circulares --- */
.icon-button-circle {
    font-family: var(--font-pixel);
    color: var(--color-text);
    background-color: #754641;
    border: none;
    border-bottom: 4px solid #4D2D28;
    width: 40px;  
    height: 40px; 
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.1s ease-out;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1rem;
	border-bottom-width: 3px;
}

.icon-button-circle:hover {
    background-color: #9D5953;
}

.icon-button-circle:active {
    transform: translateY(3px);
    border-bottom: 0px;
    background-color: #9D5953;
}

/* ========================================================= */
/* --- NUEVOS ESTILOS PARA LA BARRA DE HERRAMIENTAS (HOTBAR) --- */
/* ========================================================= */

/* El contenedor principal que se posiciona en la parte inferior */
#toolbar-container {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%); /* Truco para centrarlo perfectamente */
    
    display: flex;
    align-items: center; /* Alinea el hotbar y el bot칩n de inventario verticalmente */
    gap: 1rem; /* Espacio entre el hotbar y el bot칩n */
    
    z-index: 50; /* Asegura que est칠 por encima del mapa */
}

/* El contenedor de los 9 slots */
#hotbar {
    display: flex;
    gap: 4px; /* Peque침o espacio entre cada slot */
    
    /* Reutilizamos el estilo de borde de los otros paneles */
    padding: 8px;
    border-style: solid;
    border-width: 12px;
    border-image-source: url('../assets/ui_panel_border.png');
    border-image-slice: 4;
    border-image-repeat: repeat;
    background-color: #432834;
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
}

/* Estilo para cada uno de los slots del inventario */
.hotbar-slot {
    width: 64px;
    height: 64px;
    background-color: rgba(0, 0, 0, 0.4);
    border: 3px solid var(--color-plot-border);
    border-radius: 8px;
    
    /* Para posicionar el contador de 칤tems */
    position: relative; 
    
    /* Para mostrar la imagen del 칤tem */
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
    
    cursor: pointer;
    transition: transform 0.1s ease-out;
}

.hotbar-slot:hover {
    transform: scale(1.05); /* Un peque침o efecto al pasar el rat칩n */
}

/* Estilo para el slot que est치 actualmente seleccionado */
.hotbar-slot.active-slot {
    border-color: #feeb7a; /* Un borde amarillo brillante para destacarlo */
    box-shadow: 0 0 10px #feeb7a;
    transform: scale(1.1);
}

/* Estilo para el n칰mero que muestra la cantidad de 칤tems */
.item-count {
    position: absolute;
    bottom: 2px;
    right: 5px;
    
    font-size: 1rem;
    color: var(--color-text);
    text-shadow: 2px 2px 0 var(--color-shadow);
    
    /* Evita que el texto del contador intercepte los clics del rat칩n */
    pointer-events: none; 
}

/* Ajuste para el bot칩n de inventario */
#inventory-button {
    /* El bot칩n ya usa .icon-button-circle, as칤 que solo necesita un tama침o */
    width: 64px;
    height: 64px;
    font-size: 2rem; /* Tama침o del emoji de la mochila */
}